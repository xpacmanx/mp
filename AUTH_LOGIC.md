# Логика авторизации - различение первичного входа и потери токена

## Проблема
Пользователь не должен видеть загрузку данных на фоне при первичном входе на сайт. Модальное окно логина должно показываться только в двух случаях:
1. Пользователь нажал "Выйти" (logout)
2. Токен истек во время работы (потеря токена)

## Решение

### Отслеживание состояния авторизации
- **`wasAuthenticated`** - флаг, показывающий был ли пользователь авторизован ранее
- **`hadToken`** - флаг в localStorage для сохранения информации о том, что пользователь был авторизован

### Логика показа модального окна

#### Первичный вход (первый раз на сайте)
- Пользователь заходит на сайт без токенов
- `wasAuthenticated = false`, `hadToken = false`
- **НЕ показываем** модальное окно логина
- Показываем страницу с сообщением "Требуется авторизация" и кнопкой "Войти в систему"

#### Потеря токена (пользователь был авторизован)
- Пользователь был авторизован, но токен истек
- `wasAuthenticated = true`, `hadToken = true`
- **Показываем** модальное окно логина автоматически

#### Выход из системы (logout)
- Пользователь нажал "Выйти"
- Очищаем токены, но сохраняем `hadToken = true`
- **Показываем** модальное окно логина

### Компоненты

#### AuthGuard.vue
- Оборачивает контент приложения
- Показывает контент только авторизованным пользователям
- Для неавторизованных показывает сообщение с кнопкой входа

#### App.vue
- Использует AuthGuard для защиты контента
- Проверяет состояние авторизации при загрузке
- Показывает модальное окно только при потере токена

#### Router (index.js)
- Навигационный guard проверяет токены
- Показывает модальное окно только если `hadToken = true`
- Разрешает навигацию в любом случае

### Поток работы

1. **Первичный вход:**
   ```
   Пользователь заходит → Нет токенов → Показываем страницу с кнопкой входа
   ```

2. **Потеря токена:**
   ```
   Пользователь работает → Токен истек → Показываем модальное окно
   ```

3. **Выход из системы:**
   ```
   Пользователь нажимает "Выйти" → Очищаем токены → Показываем модальное окно
   ```

4. **Успешный вход:**
   ```
   Пользователь вводит логин/пароль → Устанавливаем hadToken = true → Обновляем страницу
   ```

### Преимущества
- ✅ Пользователь не видит загрузку данных при первичном входе
- ✅ Модальное окно показывается только при необходимости
- ✅ Четкое различие между первичным входом и потерей токена
- ✅ Контент защищен от неавторизованных пользователей
- ✅ Удобный UX с кнопкой входа на странице 